[toc]

# 统一权限系统接入-技术方案

## 项目接入权限系统情况

| 项目名称      | 是否接入旧权限 | 是否改造 | 备注                   |
| ------------- | -------------- | -------- | ---------------------- |
| ==bond-sale== | 是             | 是       |                        |
| ==label==     | 是             | 是       |                        |
| match         | 否             | 否       |                        |
| dr-basic      | 否             | 否       |                        |
| ccdc-service  | 否             | 否       |                        |
| bond-sync     | 否             | 否       |                        |
| chat-parse    | 否             | 否       |                        |
| open-api      | 否             | 否       | 其他几个项目由义桑整理 |

## 新老权限、业务接口改造

>  详见：[《权限接口改造》](https://doc.weixin.qq.com/sheet/e3_AMMAAwY4AFMNjeqfeI2SCW9Mm81XT?scode=AM8AmQdmAAw9WmAibFAMMAAwY4AFM&amp&tab=ltrw0m&tab=qg9bmh)

## 通用权限模块

### 权限码常量类

> 维护一份全量权限码，所有项目共用

### 新旧权限码不一致集合

> 1023-1-4 (新债库管理员)  -> 201002 (本分组)

### 权限码层级维护

> 枚举类只维护==直属==层级关系，比如：
>
> --- 新债库
>
> ​	| ---- 信用债/利率债
>
> ​    | ---- ABS/ABN

### 兼容旧权限接口（返回值保持一致）的新权限业务接口封装



### 权限码说明

| 名称                     | 旧代码      | 新代码      | 使用点                                                       | 备注                    |
| ------------------------ | ----------- | ----------- | ------------------------------------------------------------ | ----------------------- |
| 新债销售                 | 1023        | 1023        | 暂无使用，旧代码使用的是==1032==（有问题）<br />需要在判断分组版本的逻辑中使用 |                         |
| 数据范围（新增）         |             | 201001      | ~~==灰度==判断用户角色；<br />用户可操作数据范围~~           | ~~confirmUserRoleType~~ |
| 本分组（新增）           |             | 201002      | ~~==灰度==判断用户角色；<br />用户可操作数据范围~~           |                         |
| 本部门（新增）           |             | 201003      | ==~~灰度==判断用户角色；<br />用户可操作数据范围~~           |                         |
| 本人（新增）             |             | 201004      | ==~~灰度==判断用户角色；<br />用户可操作数据范围~~           |                         |
| 全局设置                 | 1086        | 1086        |                                                              |                         |
| 债券负责人设置           | 1086-1      | 1086-1      |                                                              |                         |
| 债券清理时间设置（新增） |             | 202001      |                                                              |                         |
| 债券提前截标设置（新增） |             | 202002      |                                                              |                         |
| 截标提醒设置（新增）     |             | 202003      |                                                              |                         |
| 投标量限制（新增）       |             | 202004      |                                                              |                         |
| 公告表头设置（新增）     |             | 202005      |                                                              |                         |
| 指导信息                 | 1080        | 1080        |                                                              |                         |
| 外部识别                 | 1080-2      | 1080-2      |                                                              |                         |
| 内部转发                 | 1080-3      | 1080-3      |                                                              |                         |
| 外部识别（移动）         | 1080-4      | 1080-4      |                                                              |                         |
| 内部转发（移动）         | 1080-5      | 1080-5      |                                                              |                         |
| 群发-本司接标人员        | 1080-6      | 1080-6      |                                                              |                         |
| 发行结果汇总             | 1080-7      | 1080-7      |                                                              |                         |
| 指导汇总                 | 1080-8      | 1080-8      |                                                              |                         |
| 同步指导                 | 1080-9      | 1080-9      |                                                              |                         |
| 新债库                   | 1023-1      | 1023-1      |                                                              |                         |
| 普通用户                 | 1023-1-3    | --          | ~~==灰度==判断用户角色~~                                     |                         |
| 管理员                   | 1023-1-4    | --          | ~~灰度判断用户角色~~                                         |                         |
| 信用债/利率债            | 1023-1-20   | 1023-1-20   |                                                              |                         |
| 债券导入                 | 1023-1-20-1 | 1023-1-20-1 |                                                              |                         |
| 债券删除、编辑           | 1023-1-20-2 | 1023-1-20-2 |                                                              |                         |
| 附件上传、删除、对外开放 | 1023-1-20-4 | 1023-1-20-4 |                                                              |                         |
| ABS/ABN                  | 1023-1-21   | 1023-1-21   |                                                              |                         |
| 债券导入                 | 1023-1-21-1 | 1023-1-21-1 |                                                              |                         |
| 债券删除、编辑           | 1023-1-21-2 | 1023-1-21-2 |                                                              |                         |
| 附件上传、删除、对外开放 | 1023-1-21-4 | 1023-1-21-4 |                                                              |                         |
| 未公告券                 | 1023-1-22   | 1023-1-22   |                                                              |                         |
| 债券导入                 | 1023-1-22-1 | 1023-1-22-1 |                                                              |                         |
| 债券删除、编辑           | 1023-1-22-2 | 1023-1-22-2 |                                                              |                         |
| 附件上传、删除、对外开放 | 1023-1-22-4 | 1023-1-22-4 |                                                              |                         |
| 发送信息                 | 1023-1-1    | 1023-1-1    |                                                              |                         |
| 同业                     | 1023-1-1-1  | 1023-1-1-1  |                                                              |                         |
| QT群                     | 1023-1-1-2  | 1023-1-1-2  |                                                              |                         |
| 配置广告                 | 1023-1-2    | 1023-1-2    |                                                              |                         |
| 债券状态手动变更         | 1023-1-10   | 1023-1-10   |                                                              |                         |
| 询价管理                 | 1030        | 1030        |                                                              |                         |
| 普通用户                 | 1030-1      | --          | ==~~灰度==判断用户角色~~                                     |                         |
| 管理员                   | 1030-2      | --          | ==~~灰度==判断用户角色~~                                     |                         |
| 开启询价                 | 1030-3      | 1030-3      |                                                              |                         |
| 投标汇总                 | 1008        | 1008        |                                                              |                         |
| 普通用户                 | 1008-1      | --          | ==~~灰度==判断用户角色~~                                     |                         |
| 管理员                   | 1008-2      | --          | ==灰度==~~判断用户角色~~                                     |                         |
| 部门管理员               | 1008-9      | --          | ~~==灰度==判断用户角色~~                                     |                         |
| 计算指导                 | 1008-4      | 1008-4      |                                                              |                         |
| 标记已投                 | 1008-5      | 1008-5      |                                                              |                         |
| 薄记预览                 | 1008-6      | 1008-6      |                                                              |                         |
| 标位采集                 | 1008-7      | 1008-7      |                                                              |                         |
| 语义识别                 | 1008-8      | 1008-8      |                                                              |                         |
| 提交CCDC                 | 1008-9      | 1008-9      |                                                              |                         |
| 移动端标位汇总           | 1008-10     | 1008-10     |                                                              |                         |
| 债券信息修改             | 1008-11     | 1008-11     |                                                              |                         |
| 下行接口                 | 1008-12     | 1008-12     |                                                              |                         |
| 手动下传                 | 1008-12-1   | 1008-12-1   |                                                              |                         |
| 自动下传                 | 1008-12-2   | 1008-12-2   |                                                              |                         |
| 额度分配                 | 1029        | 1029        |                                                              |                         |
| 普通用户                 | 1029-1      | --          | ~~==灰度==判断用户角色~~                                     |                         |
| 管理员                   | 1029-2      | --          | ==~~灰度==判断用户角色~~                                     |                         |
| 未中标                   | 1029-3      | 1029-3      |                                                              |                         |
| ~~中标分配台账~~         | ~~1029-4~~  | ~~1029-4~~  |                                                              |                         |
| 表头配置                 | 1029-7      | 1029-7      |                                                              |                         |
| 分行汇总                 | 1029-7-1    | 1029-7-1    |                                                              |                         |
| 对手方汇总               | 1029-7-2    | 1029-7-2    |                                                              |                         |
| 数据统计                 | 1029-8      | 1029-8      |                                                              |                         |
| 分行汇总                 | 1029-8-1    | 1029-8-1    |                                                              |                         |
| 对手方汇总               | 1029-8-2    | 1029-8-2    |                                                              |                         |
| 缴款分销                 | 1033        | 1033        |                                                              |                         |
| 普通用户                 | 1033-1      | 1033-1      |                                                              |                         |
| 管理员                   | 1033-2      | 1033-2      |                                                              |                         |
| 部门管理员               | 1033-5      | 1033-5      |                                                              |                         |
| 提交CCDC                 | 1033-3      | 1033-3      |                                                              |                         |
| 分销单下载               | 1033-4      | 1033-4      |                                                              |                         |
| 群报价                   | 1035        | 1035        |                                                              |                         |
| 数据统计                 | 1081        | 1081        |                                                              |                         |
| 对手方统计               | 1081-1      | 1081-1      |                                                              |                         |
| 客户行为提醒             | 1081-2      | 1081-2      |                                                              |                         |
| 意向客户设置             | 1081-3      | 1081-3      |                                                              |                         |
| 中标分配台账（调动）     | 1029-4      | 1029-4      |                                                              |                         |
|                          |             |             |                                                              |                         |
|                          |             |             |                                                              |                         |

| 名称                     | 旧代码    | 新代码    | 使用点                   | 备注 |
| ------------------------ | --------- | --------- | ------------------------ | ---- |
| 新债投标                 | 1027      | 1027      |                          |      |
| 数据范围                 |           | 211001    |                          |      |
| 本分组                   |           | 211002    |                          |      |
| 本人                     |           | 211003    |                          |      |
| 指导信息                 | 1085      | 1085      |                          |      |
| 外部识别                 | 1085-1    | 1085-1    |                          |      |
| 内部转发                 | 1085-2    | 1085-2    |                          |      |
| 发行结果汇总             | 1085-3    | 1085-3    |                          |      |
| 指导汇总                 | 1085-4    | 1085-4    |                          |      |
| 同步指导                 | 1085-5    | 1085-5    |                          |      |
| 新债库                   | 1027-1    | 1027-1    |                          |      |
| 普通用户                 | 1027-1-3  | --        | ~~==灰度==判断用户角色~~ |      |
| 管理员                   | 1027-1-4  | --        | ==~~灰度==判断用户角色~~ |      |
| 债券删除、编辑           | 1027-1-9  | 1027-1-9  |                          |      |
| 债券状态手动变更         | 1027-1-10 | 1027-1-10 |                          |      |
| 附件上传、删除、对外开放 | 1027-1-11 | 1027-1-11 |                          |      |
| 债券导入                 | 1027-1-20 | 1027-1-20 |                          |      |
| 投标管理                 | 1031      | 1031      |                          |      |
| 普通用户                 | 1031-1    | --        | ==~~灰度==判断用户角色~~ |      |
| 管理员                   | 1031-2    | --        | ==~~灰度==判断用户角色~~ |      |
| 语义识别                 | 1031-3    | 1031-3    |                          |      |
| 缴款分销                 | 1034      | 1034      |                          |      |
| 普通用户                 | 1034-1    | --        | ==~~灰度==判断用户角色~~ |      |
| 管理员                   | 1034-2    | --        | ==~~灰度==判断用户角色~~ |      |
| 提交CCDC                 | 1034-4    | 1034-4    |                          |      |
| 分销单下载               | 1034-3    | 1034-3    |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |
|                          |           |           |                          |      |